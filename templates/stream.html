<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ stream_name }} - streaming</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
    <h1>这是 {{ stream_name }} 的直播</h1>
    <video id="video" width="100%" height="720" controls autoplay class="mb-3"></video>
    <script>
        var video = document.getElementById('video');
        var videoSrc = "{{ hls_url }}";
        if(Hls.isSupported()){
            var hls = new Hls({
            maxBufferLength: 20,    // 最大缓冲长度
            maxMaxBufferLength: 30
        });

            hls.loadSource(videoSrc);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED,function(){ video.play(); });
        } else if(video.canPlayType('application/vnd.apple.mpegurl')){
            video.src = videoSrc;
            video.addEventListener('loadedmetadata',function(){ video.play(); });
        }
    </script>
    <p>RTMP 推流/播放地址：<code>{{ rtmp_url }}</code></p>
    <a class="btn btn-secondary" href="/">返回首页</a>
</div>
</body>
</html>
